<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Security :: Apache Logging Services</title>
    <link rel="canonical" href="https://logging.apache.org/security.html">
    <meta name="generator" content="Antora 3.2.0-alpha.11">
<link rel="stylesheet" href="./_/css/site.css">
<link rel="icon" href="./_/../_images/favicon.ico" type="image/x-icon">
<!-- `@asciidoctor/tabs` extension styles -->
<link rel="stylesheet" href="./_/css/vendor/tabs.css">
<style>
  /* Swap colors of `IMPORTANT` and `WARNING` blocks */ 
  .doc .admonitionblock.important .icon { background-color: #f70; }
  .doc .admonitionblock.warning .icon { background-color: #e40046; }
  /* Default `h4`, `h5`, and `h6` are smaller than the normal text, fix header font sizing: */
  .doc h1 { font-size: 1.9rem; }
  .doc h2 { font-size: 1.7rem; }
  .doc h3 { font-size: 1.5rem; font-weight: 400; }
  .doc h4 { font-size: 1.3rem; font-weight: 500; }
  .doc h5 { font-size: 1.1rem; font-weight: 500; text-decoration: underline; }
  .doc h6 { font-size: 0.9rem; font-weight: 500; text-decoration: underline; }
  /* Default `code`, `pre`, and `.colist` (source code annotations) fonts are too big, adjust them: */
  .doc .colist>table code, .doc p code, .doc thead code { font-size: 0.8em; }
  .doc pre { font-size: 0.7rem; }
  .doc .colist { font-size: 0.75rem; }
  /* Make links more visible: */
  .doc a { text-decoration: underline; }
  .doc a code { text-decoration: underline; color: #1565c0; }
  /* Make nav bar wider */
  .nav-container { width:19rem; }
  /* Tab header fonts aren't rendered good, adjusting the font weight: */
  .tablist > ul li { font-weight: 500; }
  /* `page-toclevels` greater than 4 are not supported by Antora UI, patching it: */
  .toc .toc-menu li[data-level="4"] a {
    padding-left: 2.75rem;
  }
  /* Replace the default highlight.js color for strings from red (unnecessarily signaling something negative) to green: */
  .hljs-string {
    color: #0f8532;
  }
</style>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
    <a class="navbar-item" href="https://logging.apache.org">Logging Services</a>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://apache.org">a project of&nbsp;<strong>Apache Software Foundation</strong></a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ROOT" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="index.html">Home</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">About</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="guidelines.html">Guidelines</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="charter.html">Charter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="team-list.html">Team</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="processes.html">Processes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://cwiki.apache.org/confluence/display/LOGGING/Home">Wiki</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="what-is-logging.html">What is logging?</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="download.html">Download</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="support.html">Support</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="security.html">Security</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="xml/ns/index.html">XML Schema</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="blog/index.html">Blog</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="https://apache.org">The ASF</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://apache.org/licenses/">License</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://apache.org/foundation/sponsorship">Donate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://apache.org/foundation/sponsors">Thanks</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="security.html">Security</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="https://github.com/apache/logging-site/edit/main/src/site/antora/modules/ROOT/pages/security.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Security</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The Logging Services Security Team takes security seriously.
This allows our users to place their trust in Log4j for protecting their mission-critical data.
On this page, we will help you find guidance on security-related issues and access to known vulnerabilities.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p><a href="/log4j/1.x">Log4j 1</a> has <a href="https://blogs.apache.org/foundation/entry/apache_logging_services_project_announces">reached End of Life</a> in 2015, and is no longer supported.
Vulnerabilities reported after August 2015 against Log4j 1 are not checked and will not be fixed.
Users should <a href="/log4j/2.x/manual/migration.html">upgrade to Log4j 2</a> to obtain security fixes.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="support"><a class="anchor" href="#support"></a>Getting support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you need help on building or configuring Logging Services projects or other help on following the instructions to mitigate the known vulnerabilities listed here, please use our <a href="support.html#discussions" class="xref page">user support channels</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you need to apply a source code patch, use the building instructions for the project version that you are using.
These instructions can be found in <code>BUILDING.adoc</code>, <code>BUILDING.md</code>, etc. files distributed with the sources.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reporting"><a class="anchor" href="#reporting"></a>Reporting vulnerabilities</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you have encountered an unlisted security vulnerability or other unexpected behaviour that has a security impact, or if the descriptions here are incomplete, please report them <strong>privately</strong> to <a href="mailto:security@logging.apache.org">the Logging Services Security Team</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We urge you to <strong>carefully read the threat model</strong> detailed in following sections before submitting a report.
It guides users on certain safety instructions while using Logging Services software and elaborates on what counts as an unexpected behaviour that has a security impact.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="threat-common"><a class="anchor" href="#threat-common"></a>Common threat model</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All the logging frameworks maintained by Apache Logging Services (<a href="https://logging.apache.org/log4cxx/index.html">Log4cxx</a>,
<a href="https://logging.apache.org/log4j/index.html">Log4j</a>
and
<a href="https://logging.apache.org/log4net/index.html">Log4net</a>) face similar challenges from malicious actors.
The following sections outline the most common threats to logging frameworks and clarify the assumptions regarding the origin and trustworthiness of various data sources.
Vulnerability reports that do not adhere to these assumptions will not be accepted and are <strong>not</strong> eligible for the <a href="https://yeswehack.com/programs/log4j-bug-bounty-program">YesWeHack Bug Bounty Program</a>.</p>
</div>
<div class="sect2">
<h3 id="threat-common-users"><a class="anchor" href="#threat-common-users"></a>User types</h3>
<div class="paragraph">
<p>Apache Logging Services distinguishes two kinds of users:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Trusted Users</dt>
<dd>
<div class="paragraph">
<p>Application developers and administrators are considered <strong>trusted</strong> users.
They have unrestricted access to all the features of the logging framework and the environment it is deployed to.</p>
</div>
</dd>
<dt class="hdlist1">Untrusted Users</dt>
<dd>
<div class="paragraph">
<p>All the other users are considered untrusted.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="threat-common-sources"><a class="anchor" href="#threat-common-sources"></a>Data sources</h3>
<div class="paragraph">
<p>Logging systems read data from multiple sources that are controlled by both trusted and untrusted users:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Trusted Sources</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Log4cxx, Log4j, and Log4net <strong>trust</strong> environment variables, configuration properties, and configuration files.
To maintain security, the following responsibilities fall on the deployer:</p>
<div class="ulist">
<ul>
<li>
<p>Ensure that untrusted parties do not have write access to these resources.</p>
</li>
<li>
<p>Ensure these resources are transmitted only over <strong>confidential</strong> channels (e.g., HTTPS, secure file systems).</p>
</li>
<li>
<p>Be aware that <strong>non-confidential</strong> channels such as HTTP or JMX are <strong>disabled by default</strong> to prevent accidental exposure.</p>
</li>
<li>
<p>If configuration files use interpolation features (e.g., (<a href="https://logging.apache.org/log4j/2.x/manual/lookups.html">Log4j Lookups</a>)), ensure that only trusted data sources are used.</p>
</li>
<li>
<p>Pay special attention to values stored in the context map (see <a href="https://logging.apache.org/log4j/2.x/manual/thread-context.html">Thread Context in Log4j</a>).
Although the context map is only accessible by developers, it has been known to include user-provided data, such as HTTP headers, which can introduce risks.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The logging frameworks <strong>trust</strong> that the objects passed to the log statements can be safely converted to strings:</p>
<div class="ulist">
<ul>
<li>
<p>These frameworks should not be used to log deserialized data from untrusted sources.
See <a href="https://owasp.org/www-community/vulnerabilities/Deserialization_of_untrusted_data">the related OWASP guide</a> for details.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If parameterized logging is used, the format string is <strong>trusted</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Programmers <strong>should</strong> use compile-time constants as format strings to prevent attackers from tampering messages.
See <a href="https://logging.apache.org/log4j/2.x/manual/api.html#best-practice-concat">Don&#8217;t use string concatenation</a> for an example.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Untrusted Sources</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Log4cxx, Log4j and Log4net <strong>do not</strong> trust log messages.
No particular input validation for log messages is necessary.</p>
</li>
<li>
<p>They <strong>do not</strong> trust the string representation of log parameters.</p>
</li>
<li>
<p>The logging frameworks do not trust neither the keys nor the values in the thread context.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="threat-common-threat"><a class="anchor" href="#threat-common-threat"></a>Threats</h3>
<div class="paragraph">
<p>These are the most commonly encountered threats for users of Log4cxx, Log4j and Log4net:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Log Injection (<a href="https://cwe.mitre.org/data/definitions/117.html">CWE-117</a>)</dt>
<dd>
<div class="paragraph">
<p>Log injection is a common attack vector to hide malicious activity in an application.
Regarding this threat:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Unstructured layouts</strong> such as <a href="https://logging.apache.org/log4j/2.x/manual/pattern-layout.html">Pattern Layout in Log4j</a> do <strong>not</strong> protect users from log injection.
These layouts are meant for <strong>human</strong> and not computer consumption.</p>
</li>
<li>
<p>Log4cxx, Log4j and Log4net <strong>must</strong> prevent log injection in <strong>structured</strong> layouts, such as XML, JSON and RFC 5424.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Supply chain attacks (<a href="https://cwe.mitre.org/data/definitions/1357.html">CWE-1357</a>)</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Apache Logging Services projects <strong>do</strong> check the quality of our dependencies.</p>
</li>
<li>
<p>Deprecated components such as the
<a href="https://logging.apache.org/log4j/2.x/manual/appenders/database.html#CassandraAppender">Cassandra</a>,
<a href="https://logging.apache.org/log4j/2.x/manual/appenders/message-queue.html#KafkaAppender">Kafka</a>
and
<a href="https://logging.apache.org/log4j/2.x/manual/appenders/database.html#CouchDbProvider">CouchDB</a>
appenders are provided for backward compatibility purposes only.
While we actively check for vulnerabilities in those components, they are <em>de facto</em> unmaintained, and we discourage their usage in production.</p>
</li>
<li>
<p>All Apache Logging Services are signed with one of the keys in the Logging Services PMC
<a href="https://downloads.apache.org/logging/KEYS">KEYS file</a>.
We do <strong>not</strong> support artifacts that do not have a valid signature, and we encourage users to always check the integrity of the downloaded components.
Additional information on how to verify releases signatures is available on the <a href="download.html" class="xref page">Download page</a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Information disclosure (<a href="https://cwe.mitre.org/data/definitions/200.html">CWE-200</a>)</dt>
<dd>
<div class="paragraph">
<p>Since logging frameworks implement information disclosure by design:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It is up to the deployer to prevent unauthorized access to log files and to ensure that the appropriate log levels are configured.</p>
</li>
<li>
<p>It is up to the programmer to document which log levels and markers <em>might</em> contain sensitive data.
Attention should be brought to the fact that libraries on which an application depends might have a different log level and marker convention.</p>
</li>
<li>
<p><strong>Log masking</strong> techniques are out-of-scope for Log4cxx, Log4j, and Log4net.
It is up to the developer to ensure that sensitive data is properly masked <strong>before</strong> it is passed to the logging implementation.
For this purpose, <strong>third-party</strong> frameworks like
<a href="https://github.com/palantir/safe-logging">Safe-Logging</a>
should be used.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Log reliability (e.g. <a href="https://cwe.mitre.org/data/definitions/778.html">CVE-778</a>)</dt>
<dd>
<div class="paragraph">
<p>Log4j is designed with <strong>reliability</strong> in mind:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>By <strong>default</strong>, Log4j <strong>should</strong> deliver log events to the appropriate resource even during a reconfiguration event or will log an error.</p>
</li>
<li>
<p>While log events will be delivered to a resource, not all resources provide a confirmation mechanism.
To ensure reliability along the entire logging pipeline, it is up to the deployer to use reliable transmission components:
files, loopback network sockets or
<a href="https://logging.apache.org/log4j/2.x/manual/appenders/message-queue.html">message-queue-based systems</a>
for example.</p>
</li>
<li>
<p>Log4j provides configuration options that discard log events if the load on the application is high.
Using these options invalidates the reliability guarantees.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Denial of service (<a href="https://cwe.mitre.org/data/definitions/779.html">CVE-779</a>)</dt>
<dd>
<div class="paragraph">
<p>Since our logging frameworks are designed with reliability in mind:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Our frameworks go to great lengths to minimize performance overhead, minimize latency and maximizing throughput.
Since a universal solution does not exist, many configuration options exist to adapt the performance characteristics to a specific application.
See
<a href="https://logging.apache.org/log4j/2.x/manual/performance.html">Performance</a>
for more information.</p>
</li>
<li>
<p>It is up to the deployer to ensure that the appenders can keep up with the logs written by using the appropriate appenders and configuring the appropriate level of logs.</p>
</li>
<li>
<p>It is up to the developer to ensure that log statements, which are not enabled, generate minimal overhead.
See the
<a href="https://logging.apache.org/log4j/2.x/manual/api.html#best-practice-concat">Log4j API Best Practices</a>, for example.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Improper neutralization of Special Elements (<a href="https://cwe.mitre.org/data/definitions/138.html">CWE-138</a>)</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Log4cxx, Log4j, and Log4net <strong>do</strong> allow users to pass untrusted strings to log statements and thread context, except in the format string of parameterized logging, as mentioned above.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="policy"><a class="anchor" href="#policy"></a>Vulnerability handling policy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Logging Services Security Team follows the <a href="https://www.apache.org/security/committers.html">ASF Project Security</a> guide for handling security vulnerabilities.</p>
</div>
<div class="paragraph">
<p>Reported security vulnerabilities are subject to voting (by means of <a href="https://logging.apache.org/guidelines.html"><em>lazy approval</em></a>, preferably) in the private <a href="mailto:security@logging.apache.org">security mailing list</a> before creating a CVE and populating its associated content.
This procedure involves only the creation of CVEs and blocks neither (vulnerability) fixes, nor releases.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="vdr"><a class="anchor" href="#vdr"></a>Vulnerability Disclosure Report (VDR)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Many Logging Services projects distribute <a href="https://cyclonedx.org/capabilities/vdr">CycloneDX Software Bill of Materials (SBOM)</a> along with each deployed artifact.
This is streamlined by <a href="/logging-parent">Logging Parent</a> for Maven-based projects.</p>
</div>
<div class="paragraph">
<p>Produced SBOMs contain BOM-links referring to a <a href="https://cyclonedx.org/capabilities/vdr">CycloneDX Vulnerability Disclosure Report (VDR)</a> that Apache Logging Services uses for all projects it maintains.
This VDR is accessible through the following URL: <a href="https://logging.apache.org/cyclonedx/vdr.xml" class="bare">https://logging.apache.org/cyclonedx/vdr.xml</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="vulnerabilities"><a class="anchor" href="#vulnerabilities"></a>Known vulnerabilities</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Logging Services Security Team believes that accuracy, completeness and availability of security information is essential for our users.
We choose to pool all information on this one page, allowing easy searching for security vulnerabilities over a range of criteria.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Version ranges follow the <a href="https://github.com/package-url/vers-spec/blob/main/VERSION-RANGE-SPEC.rst">VERS specification</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Log4cxx: <code>semver</code> scheme</p>
</li>
<li>
<p>Log4j: <code>maven</code> scheme</p>
</li>
<li>
<p>Log4net: <code>nuget</code> scheme</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For brevity, mathematical interval notation is used, with the union operator (<code>∪</code>) to represent multiple ranges.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="CVE-2025-68161"><a class="anchor" href="#CVE-2025-68161"></a><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-68161">CVE-2025-68161</a></h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Summary</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">Missing TLS hostname verification in Socket appender</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">CVSS 4.x Score &amp; Vector</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.3 MEDIUM (CVSS:4.0/AV:N/AC:H/AT:N/PR:N/UI:N/VC:L/VI:N/VA:N/SC:N/SI:L/SA:N)</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Components affected</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log4j Core</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Versions affected</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[2.0-beta9, 2.25.3)</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Versions fixed</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2.25.3</code></p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="CVE-2025-68161-description"><a class="anchor" href="#CVE-2025-68161-description"></a>Description</h4>
<div class="paragraph">
<p>The Socket Appender in Log4j Core versions <code>2.0-beta9</code> through <code>2.25.2</code> does not perform TLS hostname verification of the peer certificate, even when the
<a href="https://logging.apache.org/log4j/2.x/manual/appenders/network.html#SslConfiguration-attr-verifyHostName"><code>verifyHostName</code></a>
configuration attribute or the
<a href="https://logging.apache.org/log4j/2.x/manual/systemproperties.html#log4j2.sslVerifyHostName"><code>log4j2.sslVerifyHostName</code></a>
system property is set to <code>true</code>.</p>
</div>
<div class="paragraph">
<p>This issue may allow a man-in-the-middle attacker to intercept or redirect log traffic under the following conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The attacker is able to intercept or redirect network traffic between the client and the log receiver.</p>
</li>
<li>
<p>The attacker can present a server certificate issued by a certification authority trusted by the Socket Appender’s configured trust store (or by the default Java trust store if no custom trust store is configured).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2025-68161-remediation"><a class="anchor" href="#CVE-2025-68161-remediation"></a>Remediation</h4>
<div class="paragraph">
<p>Users are advised to upgrade to Log4j Core version <code>2.25.3</code>, which fully addresses this issue.</p>
</div>
<div class="paragraph">
<p>For earlier versions, the risk can be reduced by carefully restricting the trust store used by the Socket Appender.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When configuring a trust store for Log4j Core, we recommend following established best practices.
For example,
<a href="https://csrc.nist.gov/pubs/sp/800/52/r2/final">NIST SP 800-52 Rev. 2</a>
(§4.5.2) recommends using a trust store that contains only the CA certificates required for the intended communication scope, such as a private or enterprise CA.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2025-68161-credits"><a class="anchor" href="#CVE-2025-68161-credits"></a>Credits</h4>
<div class="paragraph">
<p>This issue was discovered by Samuli Leinonen.</p>
</div>
<div class="paragraph">
<p>It was reported through the <a href="https://yeswehack.com/programs/log4j-bug-bounty-program">Log4j Bug Bounty Program on YesWeHack</a> funded by the Sovereign Tech Agency.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2025-68161-references"><a class="anchor" href="#CVE-2025-68161-references"></a>References</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-68161">CVE-2025-68161</a></p>
</li>
<li>
<p><a href="https://github.com/apache/logging-log4j2/pull/4002">Pull request that fixes the issue</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="CVE-2025-54813"><a class="anchor" href="#CVE-2025-54813"></a><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-54813">CVE-2025-54813</a></h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Summary</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">Improper escaping with JSONLayout</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">CVSS 4.x Score &amp; Vector</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.3 MEDIUM (CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:L/VA:N/SC:N/SI:L/SA:N)</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Components affected</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log4cxx</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Versions affected</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[0.11.0, 1.5.0)</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Versions fixed</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.5.0</code></p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="CVE-2025-54813-description"><a class="anchor" href="#CVE-2025-54813-description"></a>Description</h4>
<div class="paragraph">
<p>When using <code>JSONLayout</code>, not all payload bytes are properly escaped.
If an attacker-supplied message contains certain non-printable characters, these will be passed along in the message and written out as part of the JSON message.
This may prevent applications that consume these logs from correctly interpreting the information within them.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2025-54813-remediation"><a class="anchor" href="#CVE-2025-54813-remediation"></a>Remediation</h4>
<div class="paragraph">
<p>Users are recommended to upgrade to version <code>1.5.0</code>, which fixes the issue.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2025-54813-credits"><a class="anchor" href="#CVE-2025-54813-credits"></a>Credits</h4>
<div class="paragraph">
<p>This issue was discovered and remediated with support from the Sovereign Tech Agency, through the <a href="https://yeswehack.com/programs/log4j-bug-bounty-program">Log4j Bug Bounty Program on YesWeHack</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2025-54813-references"><a class="anchor" href="#CVE-2025-54813-references"></a>References</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-54813">CVE-2025-54813</a></p>
</li>
<li>
<p><a href="https://github.com/apache/logging-log4cxx/pull/512">Pull request that fixes the issue</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="CVE-2025-54812"><a class="anchor" href="#CVE-2025-54812"></a><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-54812">CVE-2025-54812</a></h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Summary</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">Improper HTML escaping in HTMLLayout</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">CVSS 4.x Score &amp; Vector</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.1 LOW (CVSS:4.0/AV:N/AC:H/AT:N/PR:N/UI:A/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N)</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Components affected</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log4cxx</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Versions affected</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[0, 1.5.0)</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Versions fixed</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.5.0</code></p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="CVE-2025-54812-description"><a class="anchor" href="#CVE-2025-54812-description"></a>Description</h4>
<div class="paragraph">
<p>When using <code>HTMLLayout</code>, logger names are not properly escaped when writing out to the HTML file.
If untrusted data is used to retrieve the name of a logger, an attacker could theoretically inject HTML or Javascript in order to hide information from logs or steal data from the user.
In order to activate this, the following sequence must occur:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Log4cxx is configured to use <code>HTMLLayout</code>.</p>
</li>
<li>
<p>Logger name comes from an untrusted string.</p>
</li>
<li>
<p>Logger with compromised name logs a message.</p>
</li>
<li>
<p>User opens the generated HTML log file in their browser, leading to potential XSS.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Because logger names are generally constant strings, we assess the impact to users as LOW.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2025-54812-remediation"><a class="anchor" href="#CVE-2025-54812-remediation"></a>Remediation</h4>
<div class="paragraph">
<p>Users are recommended to upgrade to version <code>1.5.0</code>, which fixes the issue.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2025-54812-credits"><a class="anchor" href="#CVE-2025-54812-credits"></a>Credits</h4>
<div class="paragraph">
<p>This issue was discovered and remediated with support from the Sovereign Tech Agency, through the <a href="https://yeswehack.com/programs/log4j-bug-bounty-program">Log4j Bug Bounty Program on YesWeHack</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2025-54812-references"><a class="anchor" href="#CVE-2025-54812-references"></a>References</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-54812">CVE-2025-54812</a></p>
</li>
<li>
<p><a href="https://github.com/apache/logging-log4cxx/pull/509">Pull request #509</a></p>
</li>
<li>
<p><a href="https://github.com/apache/logging-log4cxx/pull/514">Pull request #514</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="CVE-2021-44832"><a class="anchor" href="#CVE-2021-44832"></a><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44832">CVE-2021-44832</a></h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Summary</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">JDBC appender is vulnerable to remote code execution in certain configurations</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">CVSS 3.x Score &amp; Vector</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.6 MEDIUM (CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H)</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Components affected</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log4j-core</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Versions affected</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[2.0-beta7, 2.3.1) ∪ [2.4, 2.12.3) ∪ [2.13.0, 2.17.0)</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Versions fixed</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2.3.1</code> (for Java 6), <code>2.12.3</code> (for Java 7), or <code>2.17.0</code> (for Java 8 and later)</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="CVE-2021-44832-description"><a class="anchor" href="#CVE-2021-44832-description"></a>Description</h4>
<div class="paragraph">
<p>An attacker with write access to the logging configuration can construct a malicious configuration using a JDBC Appender with a data source referencing a JNDI URI which can execute remote code.
This issue is fixed by limiting JNDI data source names to the <code>java</code> protocol.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2021-44832-mitigation"><a class="anchor" href="#CVE-2021-44832-mitigation"></a>Mitigation</h4>
<div class="paragraph">
<p>Upgrade to <code>2.3.1</code> (for Java 6), <code>2.12.3</code> (for Java 7), or <code>2.17.0</code> (for Java 8 and later).</p>
</div>
<div class="paragraph">
<p>In prior releases confirm that if the JDBC Appender is being used it is not configured to use any protocol other than <code>java</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2021-44832-references"><a class="anchor" href="#CVE-2021-44832-references"></a>References</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44832">CVE-2021-44832</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/browse/LOG4J2-3242">LOG4J2-3242</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="CVE-2021-45105"><a class="anchor" href="#CVE-2021-45105"></a><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45105">CVE-2021-45105</a></h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Summary</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">Infinite recursion in lookup evaluation</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">CVSS 3.x Score &amp; Vector</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.9 MEDIUM (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H)</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Components affected</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log4j-core</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Versions affected</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[2.0-alpha1, 2.3.1) ∪ [2.4, 2.12.3) ∪ [2.13.0, 2.17.0)</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Versions fixed</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2.3.1</code> (for Java 6), <code>2.12.3</code> (for Java 7), and <code>2.17.0</code> (for Java 8 and later)</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="CVE-2021-45105-description"><a class="anchor" href="#CVE-2021-45105-description"></a>Description</h4>
<div class="paragraph">
<p>Log4j versions <code>2.0-alpha1</code> through <code>2.16.0</code> (excluding <code>2.3.1</code> and <code>2.12.3</code>), did not protect from uncontrolled recursion that can be implemented using self-referential lookups.
When the logging configuration uses a non-default Pattern Layout with a Context Lookup (for example, <code>$${ctx:loginId}</code>), attackers with control over Thread Context Map (MDC) input data can craft malicious input data that contains a recursive lookup, resulting in a <code>StackOverflowError</code> that will terminate the process.
This is also known as a <em>DoS (Denial-of-Service)</em> attack.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2021-45105-mitigation"><a class="anchor" href="#CVE-2021-45105-mitigation"></a>Mitigation</h4>
<div class="paragraph">
<p>Upgrade to <code>2.3.1</code> (for Java 6), <code>2.12.3</code> (for Java 7), or <code>2.17.0</code> (for Java 8 and later).</p>
</div>
<div class="paragraph">
<p>Alternatively, this infinite recursion issue can be mitigated in configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In PatternLayout in the logging configuration, replace Context Lookups like <code>${ctx:loginId}</code> or <code>$${ctx:loginId}</code> with Thread Context Map patterns (<code>%X</code>, <code>%mdc</code>, or <code>%MDC</code>).</p>
</li>
<li>
<p>Otherwise, in the configuration, remove references to Context Lookups like <code>${ctx:loginId}</code> or <code>$${ctx:loginId}</code> where they originate
from sources external to the application such as HTTP headers or user input.
Note that this mitigation is insufficient in releases older than <code>2.12.2</code> (for Java 7), and <code>2.16.0</code> (for Java 8 and later) as the issues fixed in those releases will still be present.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that only the <code>log4j-core</code> JAR file is impacted by this vulnerability.
Applications using only the <code>log4j-api</code> JAR file without the <code>log4j-core</code> JAR file are not impacted by this vulnerability.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2021-45105-credits"><a class="anchor" href="#CVE-2021-45105-credits"></a>Credits</h4>
<div class="paragraph">
<p>Independently discovered by Hideki Okamoto of Akamai Technologies, Guy Lederfein of Trend Micro Research working with Trend Micro&#8217;s Zero Day Initiative, and another anonymous vulnerability researcher.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2021-45105-references"><a class="anchor" href="#CVE-2021-45105-references"></a>References</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45105">CVE-2021-45105</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/browse/LOG4J2-3230">LOG4J2-3230</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="CVE-2021-45046"><a class="anchor" href="#CVE-2021-45046"></a><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45046">CVE-2021-45046</a></h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Summary</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">Thread Context Lookup is vulnerable to remote code execution in certain configurations</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">CVSS 3.x Score &amp; Vector</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.0 CRITICAL (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H)</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Components affected</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log4j-core</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Versions affected</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[2.0-beta9, 2.3.1) ∪ [2.4, 2.12.3) ∪ [2.13.0, 2.16.0)</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Versions fixed</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2.3.1</code> (for Java 6), <code>2.12.3</code> (for Java 7), and <code>2.16.0</code> (for Java 8 and later)</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="CVE-2021-45046-description"><a class="anchor" href="#CVE-2021-45046-description"></a>Description</h4>
<div class="paragraph">
<p>It was found that the fix to address <a href="#CVE-2021-44228">CVE-2021-44228</a> in Log4j <code>2.15.0</code> was incomplete in certain non-default configurations.
When the logging configuration uses a non-default Pattern Layout with a Thread Context Lookup (for example, <code>$${ctx:loginId}</code>), attackers with control over Thread Context Map (MDC) can craft malicious input data using a JNDI Lookup pattern, resulting in an information leak and remote code execution in some environments and local code execution in all environments.
Remote code execution has been demonstrated on macOS, Fedora, Arch Linux, and Alpine Linux.</p>
</div>
<div class="paragraph">
<p>Note that this vulnerability is not limited to just the JNDI lookup.
Any other Lookup could also be included in a Thread Context Map variable and possibly have private details exposed to anyone with access to the logs.</p>
</div>
<div class="paragraph">
<p>Note that only the <code>log4j-core</code> JAR file is impacted by this vulnerability.
Applications using only the <code>log4j-api</code> JAR file without the <code>log4j-core</code> JAR file are not impacted by this vulnerability.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2021-45046-mitigation"><a class="anchor" href="#CVE-2021-45046-mitigation"></a>Mitigation</h4>
<div class="paragraph">
<p>Upgrade to Log4j <code>2.3.1</code> (for Java 6), <code>2.12.3</code> (for Java 7), or <code>2.16.0</code> (for Java 8 and later).</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2021-45046-credits"><a class="anchor" href="#CVE-2021-45046-credits"></a>Credits</h4>
<div class="paragraph">
<p>This issue was discovered by Kai Mindermann of iC Consult and separately by 4ra1n.</p>
</div>
<div class="paragraph">
<p>Additional vulnerability details discovered independently by Ash Fox of Google, Alvaro Muñoz and Tony Torralba from GitHub, Anthony Weems of Praetorian, and RyotaK (@ryotkak).</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2021-45046-references"><a class="anchor" href="#CVE-2021-45046-references"></a>References</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45046">CVE-2021-45046</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/browse/LOG4J2-3221">LOG4J2-3221</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="CVE-2021-44228"><a class="anchor" href="#CVE-2021-44228"></a><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44228">CVE-2021-44228</a></h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Summary</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">JNDI lookup can be exploited to execute arbitrary code loaded from an LDAP server</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">CVSS 3.x Score &amp; Vector</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">10.0 CRITICAL (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Components affected</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log4j-core</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Versions affected</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[2.0-beta9, 2.3.1) ∪ [2.4, 2.12.2) ∪ [2.13.0, 2.15.0)</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Versions fixed</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2.3.1</code> (for Java 6), <code>2.12.2</code> (for Java 7), and <code>2.15.0</code> (for Java 8 and later)</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="CVE-2021-44228-description"><a class="anchor" href="#CVE-2021-44228-description"></a>Description</h4>
<div class="paragraph">
<p>In Log4j, the JNDI features used in configurations, log messages, and parameters do not protect against attacker-controlled LDAP and other JNDI related endpoints.
An attacker who can control log messages or log message parameters can execute arbitrary code loaded from LDAP servers.</p>
</div>
<div class="paragraph">
<p>Note that only the <code>log4j-core</code> JAR file is impacted by this vulnerability.
Applications using only the <code>log4j-api</code> JAR file without the <code>log4j-core</code> JAR file are not impacted by this vulnerability.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2021-44228-mitigation"><a class="anchor" href="#CVE-2021-44228-mitigation"></a>Mitigation</h4>
<div class="sect4">
<h5 id="CVE-2021-44228-mitigation-log4j1"><a class="anchor" href="#CVE-2021-44228-mitigation-log4j1"></a>Log4j 1 mitigation</h5>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p><a href="/log4j/1.x">Log4j 1</a> has <a href="https://blogs.apache.org/foundation/entry/apache_logging_services_project_announces">reached End of Life</a> in 2015, and is no longer supported.
Vulnerabilities reported after August 2015 against Log4j 1 are not checked and will not be fixed.
Users should <a href="/log4j/2.x/manual/migration.html">upgrade to Log4j 2</a> to obtain security fixes.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Log4j 1 does not have Lookups, so the risk is lower.
Applications using Log4j 1 are only vulnerable to this attack when they use JNDI in their configuration.
A separate CVE (<a href="https://nvd.nist.gov/vuln/detail/CVE-2021-4104">CVE-2021-4104</a>) has been filed for this vulnerability.
To mitigate, audit your logging configuration to ensure it has no <code>JMSAppender</code> configured.
Log4j 1 configurations without <code>JMSAppender</code> are not impacted by this vulnerability.</p>
</div>
</div>
<div class="sect4">
<h5 id="CVE-2021-44228-mitigation-log4j2"><a class="anchor" href="#CVE-2021-44228-mitigation-log4j2"></a>Log4j 2 mitigation</h5>
<div class="paragraph">
<p>Upgrade to Log4j <code>2.3.1</code> (for Java 6), <code>2.12.2</code> (for Java 7), or <code>2.15.0</code> (for Java 8 and later).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2021-44228-credits"><a class="anchor" href="#CVE-2021-44228-credits"></a>Credits</h4>
<div class="paragraph">
<p>This issue was discovered by Chen Zhaojun of Alibaba Cloud Security Team.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2021-44228-references"><a class="anchor" href="#CVE-2021-44228-references"></a>References</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44228">CVE-2021-44228</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/browse/LOG4J2-3198">LOG4J2-3198</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/browse/LOG4J2-3201">LOG4J2-3201</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/browse/LOG4J2-3242">LOG4J2-3242</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="CVE-2020-9488"><a class="anchor" href="#CVE-2020-9488"></a><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-9488">CVE-2020-9488</a></h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Summary</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">Improper validation of certificate with host mismatch in SMTP appender</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">CVSS 3.x Score &amp; Vector</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.7 LOW (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N)</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Components affected</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log4j-core</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Versions affected</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[2.0-beta1, 2.3.2) ∪ [2.4, 2.12.3) ∪ [2.13.0, 2.13.2)</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Versions fixed</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2.3.2</code> (for Java 6), <code>2.12.3</code> (for Java 7) and <code>2.13.2</code> (for Java 8 and later)</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="CVE-2020-9488-description"><a class="anchor" href="#CVE-2020-9488-description"></a>Description</h4>
<div class="paragraph">
<p>Improper validation of certificate with host mismatch in SMTP appender.
This could allow an SMTPS connection to be intercepted by a man-in-the-middle attack which could leak any log
messages sent through that appender.</p>
</div>
<div class="paragraph">
<p>The reported issue was caused by an error in <code>SslConfiguration</code>.
Any element using <code>SslConfiguration</code> in the Log4j <code>Configuration</code> is also affected by this issue.
This includes <code>HttpAppender</code>, <code>SocketAppender</code>, and <code>SyslogAppender</code>.
Usages of <code>SslConfiguration</code> that are configured via system properties are not affected.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2020-9488-mitigation"><a class="anchor" href="#CVE-2020-9488-mitigation"></a>Mitigation</h4>
<div class="paragraph">
<p>Upgrade to <code>2.3.2</code> (Java 6), <code>2.12.3</code> (Java 7) or <code>2.13.2</code> (Java 8 and later).</p>
</div>
<div class="paragraph">
<p>Alternatively, users can set the <code>mail.smtp.ssl.checkserveridentity</code> system property to <code>true</code> to enable SMTPS hostname verification for all SMTPS mail sessions.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2020-9488-credits"><a class="anchor" href="#CVE-2020-9488-credits"></a>Credits</h4>
<div class="paragraph">
<p>This issue was discovered by Peter Stöckli.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2020-9488-references"><a class="anchor" href="#CVE-2020-9488-references"></a>References</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-9488">CVE-2020-9488</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/browse/LOG4J2-2819">LOG4J2-2819</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="CVE-2017-5645"><a class="anchor" href="#CVE-2017-5645"></a><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-5645">CVE-2017-5645</a></h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Summary</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP/UDP socket servers can be exploited to execute arbitrary code</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">CVSS 2.0 Score &amp; Vector</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.5 HIGH (AV:N/AC:L/Au:N/C:P/I:P/A:P)</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Components affected</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log4j-core</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Versions affected</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[2.0-alpha1, 2.8.2)</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Versions fixed</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2.8.2</code> (for Java 7 and later)</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="CVE-2017-5645-description"><a class="anchor" href="#CVE-2017-5645-description"></a>Description</h4>
<div class="paragraph">
<p>When using the TCP socket server or UDP socket server to receive serialized log events from another application, a specially crafted binary payload can be sent that, when deserialized, can execute arbitrary code.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2017-5645-mitigation"><a class="anchor" href="#CVE-2017-5645-mitigation"></a>Mitigation</h4>
<div class="paragraph">
<p>Java 7 and above users should migrate to version <code>2.8.2</code> or avoid using the socket server classes.
Java 6 users should avoid using the TCP or UDP socket server classes, or they can manually backport <a href="https://github.com/apache/logging-log4j2/commit/5dcc192">the security fix commit</a> from <code>2.8.2</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2017-5645-credits"><a class="anchor" href="#CVE-2017-5645-credits"></a>Credits</h4>
<div class="paragraph">
<p>This issue was discovered by Marcio Almeida de Macedo of Red Team at Telstra.</p>
</div>
</div>
<div class="sect3">
<h4 id="CVE-2017-5645-references"><a class="anchor" href="#CVE-2017-5645-references"></a>References</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-5645">CVE-2017-5645</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/browse/LOG4J2-1863">LOG4J2-1863</a></p>
</li>
<li>
<p><a href="https://github.com/apache/logging-log4j2/commit/5dcc192">Security fix commit</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>
    Copyright © 1999-2026 <a href="https://www.apache.org/">The Apache Software Foundation</a>.
    Licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache Software License, Version 2.0</a>.
    Please read our <a href="https://privacy.apache.org/policies/privacy-policy-public.html">privacy policy</a>.
  </p>
  <p>
    Apache, Log4j, and the Apache feather logo are trademarks or registered trademarks of The Apache Software Foundation.
    Oracle and Java are registered trademarks of Oracle and/or its affiliates.
    Other names may be trademarks of their respective owners.
  </p>
</footer>
<script id="site-script" src="./_/js/site.js" data-ui-root-path="./_"></script>
<script async src="./_/js/vendor/highlight.js"></script>
<!-- `@asciidoctor/tabs` extension scripts -->
<script async src="./_/js/vendor/tabs.js"></script>
  </body>
</html>
